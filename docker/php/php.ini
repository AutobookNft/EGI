[PHP]

; ========================================
; üêò PHP CONFIGURATION - FLORENCE EGI COMPLETO (FIXED)
; ========================================
; Configurazione ottimizzata per Laravel + Spatie Media + UUM
; File uploads grandi + Performance + Security + Supervisor compatible
;
; @package FlorenceEGI Docker Setup
; @author Padmin D. Curtis (AI Partner OS3.0) for Fabio Cherici
; @version 1.3.0 (Error Log Fixed)
; @date 2025-07-21
; ========================================

; ========================================
; üöÄ PERFORMANCE SETTINGS
; ========================================

; Memory limit (importante per Spatie conversions)
memory_limit = 1G

; Execution time (per file musicali e conversioni)
max_execution_time = 600
max_input_time = 600

; ========================================
; üìÅ FILE UPLOAD SETTINGS (CRITICI)
; ========================================

; File upload settings (IMPORTANTE per brani musicali)
file_uploads = On
upload_max_filesize = 1G
max_file_uploads = 50
post_max_size = 1100M

; ========================================
; üîß GENERAL SETTINGS
; ========================================

; Error reporting
display_errors = Off
display_startup_errors = Off
log_errors = On
error_log = /var/log/php_errors.log
error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT

; Timezone
date.timezone = Europe/Rome

; Character encoding
default_charset = "UTF-8"
internal_encoding = "UTF-8"
input_encoding = "UTF-8"
output_encoding = "UTF-8"

; ========================================
; üóÑÔ∏è DATABASE SETTINGS
; ========================================

; MySQL/MariaDB settings
mysqli.default_socket = /var/run/mysqld/mysqld.sock
pdo_mysql.default_socket = /var/run/mysqld/mysqld.sock

; ========================================
; üé® IMAGE PROCESSING (Spatie Media)
; ========================================

; GD extension settings
gd.jpeg_ignore_warning = 1

; ImageMagick settings
imagick.progress_monitor = 0

; ========================================
; üìß MAIL SETTINGS
; ========================================

; Mail configuration
SMTP = localhost
smtp_port = 25
mail.add_x_header = Off

; ========================================
; üèéÔ∏è OPCACHE OPTIMIZATION
; ========================================

; OPcache settings (performance boost)
opcache.enable = 1
opcache.enable_cli = 1
opcache.memory_consumption = 256
opcache.interned_strings_buffer = 16
opcache.max_accelerated_files = 8000
opcache.revalidate_freq = 2
opcache.fast_shutdown = 1
opcache.validate_timestamps = 1

; ========================================
; üõ°Ô∏è SECURITY SETTINGS
; ========================================

; Security enhancements
expose_php = Off
allow_url_fopen = On
allow_url_include = Off

; Session security
session.cookie_httponly = 1
session.cookie_secure = 0
session.use_strict_mode = 1
session.cookie_samesite = "Lax"

; Disable dangerous functions
disable_functions = exec,passthru,shell_exec,system,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source

; ========================================
; üîÑ SESSION SETTINGS
; ========================================

; Session configuration (Laravel handles via Redis)
session.save_handler = files
session.save_path = "/tmp"
session.gc_probability = 1
session.gc_divisor = 1000
session.gc_maxlifetime = 1440

; ========================================
; üì¶ EXTENSION SETTINGS
; ========================================

; Redis settings
redis.session.locking_enabled = 1
redis.session.lock_expire = 30

; ========================================
; üìè LIMITS & TIMEOUTS
; ========================================

; Request limits
max_input_vars = 5000
max_input_nesting_level = 64

; Output settings
output_buffering = 4096
implicit_flush = Off

; Realpath cache (performance)
realpath_cache_size = 4096k
realpath_cache_ttl = 600

; ========================================
; üéØ LARAVEL SPECIFIC
; ========================================

; Auto detect line endings
auto_detect_line_endings = On

; Precision for mathematical operations
precision = 14
serialize_precision = -1

; ========================================
; üìä LOGGING DETAILED (SUPERVISOR COMPATIBLE)
; ========================================

; Log all errors but hide from users
log_errors = On
log_errors_max_len = 2048
ignore_repeated_errors = Off
ignore_repeated_source = Off
html_errors = Off
